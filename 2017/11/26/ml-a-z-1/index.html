<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Machine Learning A-Z（1） | JasonChiuCC</title>
  <meta name="author" content="JasonChiuCC">
  
  <meta name="description" content="JasonChiuCC">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="Machine Learning A-Z（1）"/>
  <meta property="og:site_name" content="JasonChiuCC"/>

  
    <meta property="og:image" content="undefined"/>
  

  <link href="/favicon.png" rel="icon">
  <link rel="alternate" href="/atom.xml" title="JasonChiuCC" type="application/atom+xml">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  

</head>


<body>
  <header id="header" class="inner"><div class="alignleft">
  <h1><a href="/">JasonChiuCC</a></h1>
  <h2><a href="/">You’ve got to find what you love</a></h2>
</div>
<nav id="main-nav" class="alignright">
  <ul>
    
      <li><a href="/">首頁</a></li>
    
      <li><a href="/archives">文章</a></li>
    
      <li><a href="/about">關於</a></li>
    
  </ul>
  <div class="clearfix"></div>
</nav>
<div class="clearfix"></div>
</header>
  <div id="content" class="inner">
    <div id="main-col" class="alignleft"><div id="wrapper"><article class="post">
  
  <div class="post-content">
    <header>
      
        <div class="icon"></div>
        <time datetime="2017-11-26T04:28:17.000Z"><a href="/2017/11/26/ml-a-z-1/">2017-11-26</a></time>
      
      
  
    <h1 class="title">Machine Learning A-Z（1）</h1>
  

    </header>
    <div class="entry">
      
        <h2 id="安裝-R-環境-amp-IDE"><a href="#安裝-R-環境-amp-IDE" class="headerlink" title="安裝 R 環境 &amp; IDE"></a>安裝 R 環境 &amp; IDE</h2><p>安裝 R 環境</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">https://cran.r-project.org/</span><br><span class="line"></span><br><span class="line">下載對應的 OS 安裝檔</span><br><span class="line">EX: Windows</span><br><span class="line">1.Download R for Windows</span><br><span class="line">2.install R for the first time</span><br><span class="line">3.Download R 3.4.2 for Windows</span><br></pre></td></tr></table></figure>
<p>安裝 R IDE</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">https://www.rstudio.com/products/rstudio/download/</span><br><span class="line"></span><br><span class="line">下載免費版本即可</span><br></pre></td></tr></table></figure>
<h2 id="安裝-Anaconda-Python"><a href="#安裝-Anaconda-Python" class="headerlink" title="安裝 Anaconda Python"></a>安裝 Anaconda Python</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">https://www.anaconda.com/download/</span><br><span class="line"></span><br><span class="line">安裝 3.6 版本</span><br><span class="line">Anaconda Python 其實類似組合包</span><br><span class="line">就是 Python + 常用到的 Lib 一起下載</span><br><span class="line">當然你也可以單純下載 Python 3.6 然後再找需要的 Lib 安裝</span><br><span class="line">不過就會比較麻煩，常常某個 Lib 需要依賴其他 Lib 等等</span><br><span class="line">所以建議直接安裝 Anaconda Python</span><br></pre></td></tr></table></figure>
<p>安裝完可以打開 <code>Anaconda Navigator</code></p>
<p>其中<code>Spyder</code> 是 Python 的 IDE</p>
<p>上方<code>View-&gt;panes</code> 可以自訂 IDE 的介面呈現</p>
<a id="more"></a>
<h2 id="資料的預先處理"><a href="#資料的預先處理" class="headerlink" title="資料的預先處理"></a>資料的預先處理</h2><p>在機器學習之前，要將給機器的 Data 做預先處理的動作</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Get the Dataset</span><br><span class="line">Importing the Libraries</span><br><span class="line">Importing the Dataset</span><br><span class="line">Missing Data</span><br><span class="line">Categorical Data</span><br><span class="line">Splitting the Dataset into the Training set and Test set</span><br><span class="line">Feature Scaling</span><br><span class="line">Data Preprocessing Template</span><br><span class="line"></span><br><span class="line">A.下載 Dataset</span><br><span class="line">B.導入標準庫</span><br><span class="line">C.導入 Dataset</span><br><span class="line">D.缺失 Data</span><br><span class="line">E.分類 Data</span><br><span class="line">F.將 Data 分為 Training set 和 Test set</span><br><span class="line">G.特徵縮放</span><br><span class="line">H.Data 預處理模板</span><br></pre></td></tr></table></figure>
<h2 id="A-下載數據集"><a href="#A-下載數據集" class="headerlink" title="A.下載數據集"></a>A.下載數據集</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.superdatascience.com/%E4%B8%8B%E8%BD%BD%E6%95%B0%E6%8D%AE%E9%9B%86/</span><br><span class="line">https://zhuanlan.zhihu.com/p/25138563</span><br></pre></td></tr></table></figure>
<p>首先開啟 data 檔案如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Country	Age	Salary	Purchased</span><br><span class="line">France	44	72000	No</span><br><span class="line">Spain	27	48000	Yes</span><br><span class="line">Germany	30	54000	No</span><br><span class="line">Spain	38	61000	No</span><br><span class="line">Germany	40		    Yes</span><br><span class="line">France	35	58000	Yes</span><br><span class="line">Spain		52000	No</span><br><span class="line">France	48	79000	Yes</span><br><span class="line">Germany	50	83000	No</span><br><span class="line">France	37	67000	Yes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">假設這是某公司中，客戶的紀錄</span><br><span class="line">分別代表此客戶的國家/年齡/薪水/是否購買過本公司的產品</span><br><span class="line"></span><br><span class="line">所以我們的目的就是要透過 ML 來建立一個機器學習模型</span><br><span class="line">預測新的客戶是否可能會購買本公司的產品</span><br></pre></td></tr></table></figure>
<p>Step1: 機器學習模型都有一個<code>自變量</code>和<code>應變量</code></p>
<p>例如在一個函數中，x 可以自由取值，所以稱為自變量(可以變化的量)</p>
<p>y 的值取決於 x ，所以稱為應變量(應其他量而變化的量)</p>
<p>以此例子來說</p>
<p>自變量 = 客戶的國家/年齡/薪水</p>
<p>應變量 = 客戶是否會購買本公司的產品 (結果)</p>
<p>Step2: 需要對 data 做預處理</p>
<h2 id="B-導入標準庫"><a href="#B-導入標準庫" class="headerlink" title="B.導入標準庫"></a>B.導入標準庫</h2><p>分別在 Python &amp; R 中導入標準庫</p>
<p>在 Python 中導入標準庫，以下 3 種幾乎每次都會使用</p>
<p>打開 Spyder 填入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># numpy 念 /nΛm pi/，as 是縮寫的意思，之後就可以直接寫 np 而不是 numpy</span><br><span class="line"># matplotlib 是一個大的庫，我們只需要其中的 pyplot 就可以寫成 matplotlib.pyplot</span><br><span class="line"># 此庫主要用來畫圖</span><br><span class="line"># 最後一個 pandas 用來導入 data 以及操作 data 使用</span><br><span class="line"></span><br><span class="line">import numpy as np</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import pandas as pd</span><br></pre></td></tr></table></figure>
<p>在 R 中導入標準庫，開啟 RStudio</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">在右下角 TAB 視窗選擇 packet，需要把以下 lib 打勾</span><br><span class="line">datasets</span><br><span class="line">graphics</span><br><span class="line">grDevices</span><br><span class="line">methods</span><br><span class="line">stats</span><br><span class="line">utils</span><br></pre></td></tr></table></figure>
<h2 id="C-導入-Dataset"><a href="#C-導入-Dataset" class="headerlink" title="C.導入 Dataset"></a>C.導入 Dataset</h2><p>為了讓程式可以讀取要導入的檔案，需要先設定工作路徑</p>
<p>設定工作路徑有 2 種方式</p>
<p>1.右上角 File Explorer 中直接切換到 data 所放的位置</p>
<p>例如你的 csv 檔案放在 d:\dataset 中，那你就切到這個位置</p>
<p>2.直接將你的 python 檔案存在和 csv 同個位置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 以下可以將 csv 導入</span><br><span class="line"># 選取程式碼按下 ctrl + enter</span><br><span class="line"></span><br><span class="line">dataset = pd.read_csv(&apos;Data.csv&apos;)</span><br></pre></td></tr></table></figure>
<p>成功之後可以透過 variable explorer 看到導入狀況</p>
<img src="/2017/11/26/ml-a-z-1/2017_11_27_1.png" alt="2017_11_27_1.png" title="">
<p>注意 python 中行列由<code>0</code> 開始，但 R 由<code>1</code>開始</p>
<p>接下來加入以下程式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">dataset = pd.read_csv(&apos;Data.csv&apos;)</span><br><span class="line">X = dataset.iloc[:, :-1].values         # 自變量</span><br><span class="line">y = dataset.iloc[:, 3].values           # 應變量</span><br><span class="line"></span><br><span class="line">iloc 表示要取出 Dataset 中的某行或某列</span><br><span class="line">後面的括號表示 [橫,直] ，如果打 : 表示所有</span><br><span class="line">例如: [:, :-1] 表示取所有橫，:-1 取所有直，但&quot;不會&quot;取最後一直</span><br><span class="line">因為最後一直是應變量所以不取，.values 是取裡面的值</span><br></pre></td></tr></table></figure>
<p>在 R 中導入 dataset</p>
<p>同樣先切換到 csv 目錄，但是還要按 more -&gt; set as Working Directory</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dataset = read.csv(&apos;Data.csv&apos;)</span><br><span class="line"></span><br><span class="line">ctrl + enter       = 執行選取程式</span><br><span class="line">ctrl shift + enter = 執行所有</span><br></pre></td></tr></table></figure>
<p>可以看到由 1 開始</p>
<p>另外在 R 中不需要做取出自變量或應變量的動作</p>
<img src="/2017/11/26/ml-a-z-1/2017_11_27_2.png" alt="2017_11_27_2.png" title="">
<h2 id="D-缺失-Data"><a href="#D-缺失-Data" class="headerlink" title="D.缺失 Data"></a>D.缺失 Data</h2><p>在 dataset 中有時候會有缺失數據的情況發生</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Country	Age	Salary	Purchased</span><br><span class="line">France	44	72000	No</span><br><span class="line">Spain	27	48000	Yes</span><br><span class="line">Germany	30	54000	No</span><br><span class="line">Spain	38	61000	No</span><br><span class="line">Germany	40		    Yes</span><br><span class="line">France	35	58000	Yes</span><br><span class="line">Spain		52000	No</span><br><span class="line">France	48	79000	Yes</span><br><span class="line">Germany	50	83000	No</span><br><span class="line">France	37	67000	Yes</span><br></pre></td></tr></table></figure>
<p>此範例就有兩個缺失數據，最簡單的作法就是直接將兩列資料刪除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Country	Age	Salary	Purchased</span><br><span class="line">France	44	72000	No</span><br><span class="line">Spain	27	48000	Yes</span><br><span class="line">Germany	30	54000	No</span><br><span class="line">Spain	38	61000	No</span><br><span class="line">France	35	58000	Yes</span><br><span class="line">France	48	79000	Yes</span><br><span class="line">Germany	50	83000	No</span><br><span class="line">France	37	67000	Yes</span><br></pre></td></tr></table></figure>
<p>但風險是可能刪掉重要的資訊，另一種方式是取其他欄位的<code>平均</code></p>
<p>以下是 python 計算平均的方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># sklearn = scikit-learn，preprocessing 是其中一個子集庫</span><br><span class="line"># Imputer 是 preprocessing 中的一個類別</span><br><span class="line"></span><br><span class="line">from sklearn.preprocessing import Imputer</span><br><span class="line">imputer     = Imputer(missing_values=&apos;NaN&apos;,strategy=&apos;mean&apos;,axis=0)</span><br><span class="line">imputer     = imputer.fit(X[:,1:3])</span><br><span class="line">X[:,1:3]    = imputer.transform(X[:,1:3])</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line">可以在類別上面輸入 ctrl + i 會出現 help 頁面</span><br><span class="line">第 1 參數表示，如何判斷為缺失數據，這邊指定只要是 &apos;NaN (Not A Number)&apos; 即為缺失數據</span><br><span class="line">第 2 參數表示，用什麼策略處理此數據</span><br><span class="line">- mean 平均</span><br><span class="line">- median 中位數</span><br><span class="line">- most_frequent 最常出現</span><br><span class="line"></span><br><span class="line">第 3 參數表示，取&quot;橫&quot;或&quot;直&quot;來計算</span><br><span class="line">- axis=0, then impute along columns.</span><br><span class="line">- axis=1, then impute along rows.</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>
<p>這時候執行可能會遇到 ImportError: cannot import name NUMPY_MKL</p>
<p>解決如下，先下載以下檔案</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.lfd.uci.edu/~gohlke/pythonlibs/#numpy</span><br><span class="line"># numpy-1.13.3+mkl-cp36-cp36m-win_amd64.whl</span><br></pre></td></tr></table></figure>
<p>關掉 Anaconda，重新以系統管理員身分啟動</p>
<p>啟動後左邊選<code>Environments</code>，按下 root 右邊三角形 -&gt; Open Terminal</p>
<p>切到剛下載<code>whl</code>檔案的地方執行 pip install numpy-1.13.3+mkl-cp36-cp36m-win_amd64.whl</p>
<p>重新打開 Spyder 即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"># X 執行如下</span><br><span class="line">array([[&apos;France&apos;, 44.0, 72000.0],</span><br><span class="line">       [&apos;Spain&apos;, 27.0, 48000.0],</span><br><span class="line">       [&apos;Germany&apos;, 30.0, 54000.0],</span><br><span class="line">       [&apos;Spain&apos;, 38.0, 61000.0],</span><br><span class="line">       [&apos;Germany&apos;, 40.0, 63777.77777777778],</span><br><span class="line">       [&apos;France&apos;, 35.0, 58000.0],</span><br><span class="line">       [&apos;Spain&apos;, 38.77777777777778, 52000.0],</span><br><span class="line">       [&apos;France&apos;, 48.0, 79000.0],</span><br><span class="line">       [&apos;Germany&apos;, 50.0, 83000.0],</span><br><span class="line">       [&apos;France&apos;, 37.0, 67000.0]], dtype=object)</span><br></pre></td></tr></table></figure>
<p>在 R 中處理缺失數據</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dataset$Age[is.na(dataset$Age)]       = mean(dataset$Age, na.rm = T)</span><br><span class="line">dataset$Salary[is.na(dataset$Salary)] = mean(dataset$Salary, na.rm = T)</span><br></pre></td></tr></table></figure>
<p>在 R 中和常見程式寫法比較不同</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">dataset$Age 或 dataset$Age[]</span><br><span class="line"></span><br><span class="line">這樣輸入會直接迭代出此陣列的 Age 數據，不用額外寫 loop</span><br><span class="line"></span><br><span class="line">[1] 44 27 30 38 40 35 NA 48 50 37</span><br><span class="line"></span><br><span class="line">如果要取其中某個值可以直接寫下標，注意是從 0 開始</span><br><span class="line"></span><br><span class="line">&gt; dataset$Age[1]</span><br><span class="line">[1] 44</span><br><span class="line">&gt; dataset$Age[2]</span><br><span class="line">[1] 27</span><br><span class="line">&gt; dataset$Age[6]</span><br><span class="line">[1] 35</span><br><span class="line">&gt; dataset$Age[11]</span><br><span class="line">[1] NA</span><br><span class="line"> </span><br><span class="line">如果要判斷是不是 na 可以這樣寫</span><br><span class="line"></span><br><span class="line">&gt; dataset$Age[is.na(dataset$Age)]</span><br><span class="line">[1] NA</span><br><span class="line">&gt; dataset$Age[!is.na(dataset$Age)]</span><br><span class="line">[1] 44 27 30 38 40 35 48 50 37</span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">依序顯示陣列中的數值是否為 na</span><br><span class="line"> </span><br><span class="line">&gt; is.na(dataset$Age)</span><br><span class="line">[1] FALSE FALSE FALSE FALSE FALSE FALSE  TRUE FALSE FALSE FALSE</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mean() 是取平均值的意思</span><br><span class="line">但如果我們輸入  mean(dataset$Age) 會變成</span><br><span class="line">&gt; mean(dataset$Age) </span><br><span class="line">[1] NA</span><br><span class="line"></span><br><span class="line">因為如果陣列中其中一個元素為 na，取平均後就會變 na</span><br><span class="line">所以要改為 mean(dataset$Age, na.rm = T)</span><br><span class="line">也就是只要是 na 就 remove(rm) 的意思</span><br></pre></td></tr></table></figure>
<p>E.分類 Data</p>
<p>目前我們的 dataset 有國家，年齡，薪水，是否購買</p>
<p>其中年齡和薪水是數字，但國家和購買不是</p>
<p>所以現在要想辦法把這些不是數字的轉為有意義的數字</p>
<p>以下是 Python 作法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.preprocessing import LabelEncoder</span><br><span class="line">labelencoder_X = LabelEncoder()</span><br><span class="line">labelencoder_X.fit_transform(X[:,0])</span><br><span class="line"></span><br><span class="line">執行後出現</span><br><span class="line">array([0, 2, 1, 2, 1, 0, 2, 0, 1, 0], dtype=int64) -&gt; 對應國家</span><br><span class="line">   Country      Age   Salary Purchased</span><br><span class="line">1   France 44.00000 72000.00        No</span><br><span class="line">2    Spain 27.00000 48000.00       Yes</span><br><span class="line">3  Germany 30.00000 54000.00        No</span><br><span class="line">4    Spain 38.00000 61000.00        No</span><br><span class="line">5  Germany 40.00000 63777.78       Yes</span><br><span class="line">6   France 35.00000 58000.00       Yes</span><br><span class="line">7    Spain 38.77778 52000.00        No</span><br><span class="line">8   France 48.00000 79000.00       Yes</span><br><span class="line">9  Germany 50.00000 83000.00        No</span><br><span class="line">10  France 37.00000 67000.00       Yes</span><br><span class="line"></span><br><span class="line">改為以下程式取代原本的 X</span><br><span class="line">from sklearn.preprocessing import LabelEncoder</span><br><span class="line">labelencoder_X = LabelEncoder()</span><br><span class="line">X[:,0] = labelencoder_X.fit_transform(X[:,0])</span><br><span class="line"></span><br><span class="line">X 顯示如下</span><br><span class="line">array([[0, 44.0, 72000.0],</span><br><span class="line">       [2, 27.0, 48000.0],</span><br><span class="line">       [1, 30.0, 54000.0],</span><br><span class="line">       [2, 38.0, 61000.0],</span><br><span class="line">       [1, 40.0, 63777.77777777778],</span><br><span class="line">       [0, 35.0, 58000.0],</span><br><span class="line">       [2, 38.77777777777778, 52000.0],</span><br><span class="line">       [0, 48.0, 79000.0],</span><br><span class="line">       [1, 50.0, 83000.0],</span><br><span class="line">       [0, 37.0, 67000.0]], dtype=object)</span><br></pre></td></tr></table></figure>
<p>不過這樣有個問題是，原本國家單純只是個名稱而已</p>
<p>如果換成數字後，就變成會有”大小”或”排序”的問題</p>
<p>所以這裡用另一個方法稱為”Dummy Encoding(虛擬編碼)”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">France  Spain   Germany</span><br><span class="line">1       0       0</span><br><span class="line">0       1       0</span><br><span class="line">0       0       1</span><br><span class="line">0       1       0</span><br><span class="line">0       0       1</span><br><span class="line">1       0       0</span><br><span class="line">0       1       0</span><br><span class="line">1       0       0</span><br><span class="line">0       0       1</span><br><span class="line">1       0       0</span><br></pre></td></tr></table></figure>
<p>這樣的好處是消除了排序的問題</p>
<p>以下是 python 的作法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.preprocessing import LabelEncoder, OneHotEncoder</span><br><span class="line">labelencoder_X = LabelEncoder()</span><br><span class="line">X[:,0] = labelencoder_X.fit_transform(X[:,0])</span><br><span class="line">onehotencoder  = OneHotEncoder(categorical_features=[0])</span><br><span class="line">X = onehotencoder.fit_transform(X).toarray()</span><br><span class="line"></span><br><span class="line"># categorical_features=[0] 裡面的 0，表示處理第 0 columns</span><br><span class="line"># 也就是國籍的部分</span><br></pre></td></tr></table></figure>
<img src="/2017/11/26/ml-a-z-1/2017_12_02_1.png" alt="2017_12_02_1.png" title="">
<p>最後是將”是否購買”也轉為數字</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">from sklearn.preprocessing import LabelEncoder, OneHotEncoder</span><br><span class="line">labelencoder_X = LabelEncoder()</span><br><span class="line">X[:,0] = labelencoder_X.fit_transform(X[:,0])</span><br><span class="line">onehotencoder  = OneHotEncoder(categorical_features=[0])</span><br><span class="line">X = onehotencoder.fit_transform(X).toarray()</span><br><span class="line"></span><br><span class="line">labelencoder_y = LabelEncoder()</span><br><span class="line">y = labelencoder_y.fit_transform(y)</span><br></pre></td></tr></table></figure>
<p>以下是 R 的作法</p>
<p>在 R 裡面有分”有序因子”和”無序因子”</p>
<p>分別表示不同類別之間是否有”順序”的區別</p>
<p>在 R 中要看 HELP 說明按”F1”</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">dataset$Country = factor(dataset$Country,</span><br><span class="line">                         levels = c(&apos;France&apos;, &apos;Spain&apos;, &apos;Germany&apos;),</span><br><span class="line">                         labels = c(1,2,3))</span><br><span class="line"># c 表示向量，執行完 dataset 變為</span><br><span class="line">   Country      Age   Salary Purchased</span><br><span class="line">1        1 44.00000 72000.00        No</span><br><span class="line">2        2 27.00000 48000.00       Yes</span><br><span class="line">3        3 30.00000 54000.00        No</span><br><span class="line">4        2 38.00000 61000.00        No</span><br><span class="line">5        3 40.00000 63777.78       Yes</span><br><span class="line">6        1 35.00000 58000.00       Yes</span><br><span class="line">7        2 38.77778 52000.00        No</span><br><span class="line">8        1 48.00000 79000.00       Yes</span><br><span class="line">9        3 50.00000 83000.00        No</span><br><span class="line">10       1 37.00000 67000.00       Yes                         </span><br><span class="line"></span><br><span class="line"># 同樣做法把&quot;是否購買也轉為數字&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">dataset$Country = factor(dataset$Country,</span><br><span class="line">                         levels = c(&apos;France&apos;, &apos;Spain&apos;, &apos;Germany&apos;),</span><br><span class="line">                         labels = c(1,2,3))</span><br><span class="line"></span><br><span class="line">dataset$Purchased = factor(dataset$Purchased,</span><br><span class="line">                         levels = c(&apos;No&apos;,&apos;Yes&apos;),</span><br><span class="line">                         labels = c(0,1))</span><br><span class="line">                         </span><br><span class="line"># 變為以下數據</span><br><span class="line">   Country      Age   Salary Purchased</span><br><span class="line">1        1 44.00000 72000.00         0</span><br><span class="line">2        2 27.00000 48000.00         1</span><br><span class="line">3        3 30.00000 54000.00         0</span><br><span class="line">4        2 38.00000 61000.00         0</span><br><span class="line">5        3 40.00000 63777.78         1</span><br><span class="line">6        1 35.00000 58000.00         1</span><br><span class="line">7        2 38.77778 52000.00         0</span><br><span class="line">8        1 48.00000 79000.00         1</span><br><span class="line">9        3 50.00000 83000.00         0</span><br><span class="line">10       1 37.00000 67000.00         1</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer>
      
        
  
  <div class="categories">
    <a href="/categories/ML/">ML</a>
  </div>

        
  
  <div class="tags">
    <a href="/tags/Machine-Learning/">Machine-Learning</a>
  </div>

        
  <div class="addthis addthis_toolbox addthis_default_style">
    
      <a class="addthis_button_facebook_like" fb:like:layout="button_count"></a>
    
    
    
    
    <a class="addthis_counter addthis_pill_style"></a>
  </div>
  <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js"></script>

      
      <div class="clearfix"></div>
    </footer>
  </div>
</article>


<section id="comment">
  <h1 class="title">留言</h1>

  
      <div id="fb-root"></div>
<script>
  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = "//connect.facebook.net/zh_TW/all.js#xfbml=1&appId=123456789012345";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

<div class="fb-comments" data-href="http://jasonchiucc.github.io/2017/11/26/ml-a-z-1/index.html" data-num-posts="5" data-width="840" data-colorscheme="dark"></div>
      
  
</section>

</div></div>
    <aside id="sidebar" class="alignright">
  <div class="search">
  <form action="//google.com/search" method="get" accept-charset="utf-8">
    <input type="search" name="q" results="0" placeholder="搜尋">
    <input type="hidden" name="q" value="site:jasonchiucc.github.io">
  </form>
</div>

  
<div class="widget tag">
  <h3 class="title" id="categories">分類</h3>
<!--   
	
		<li><a class = "list-2"href="/categories/Swift/AutoLayout/">AutoLayout</a><small>1</small></li>
     
  
	
		<li><a class = "list-2"href="/categories/IOS/BLE/">BLE</a><small>1</small></li>
     
  
	
		<li><a href="/categories/C/">C</a><small>8</small></li>
	
  
	
		<li><a href="/categories/Chrome/">Chrome</a><small>1</small></li>
	
  
	
		<li><a class = "list-2"href="/categories/PHP/Composer/">Composer</a><small>1</small></li>
     
  
	
		<li><a href="/categories/DataStructures/">DataStructures</a><small>2</small></li>
	
  
	
		<li><a class = "list-2"href="/categories/Swift/DesignPattern/">DesignPattern</a><small>3</small></li>
     
  
	
		<li><a href="/categories/Firebase/">Firebase</a><small>5</small></li>
	
  
	
		<li><a href="/categories/Firefox/">Firefox</a><small>5</small></li>
	
  
	
		<li><a href="/categories/GCC/">GCC</a><small>1</small></li>
	
  
	
		<li><a href="/categories/Git/">Git</a><small>1</small></li>
	
  
	
		<li><a href="/categories/Hexo/">Hexo</a><small>3</small></li>
	
  
	
		<li><a href="/categories/IOS/">IOS</a><small>1</small></li>
	
  
	
		<li><a href="/categories/Laravel/">Laravel</a><small>8</small></li>
	
  
	
		<li><a href="/categories/Linux/">Linux</a><small>14</small></li>
	
  
	
		<li><a href="/categories/ML/">ML</a><small>2</small></li>
	
  
	
		<li><a href="/categories/Machine-Learning/">Machine-Learning</a><small>1</small></li>
	
  
	
		<li><a class = "list-2"href="/categories/Storage/Nand-Flash/">Nand-Flash</a><small>1</small></li>
     
  
	
		<li><a href="/categories/Other/">Other</a><small>1</small></li>
	
  
	
		<li><a href="/categories/PHP/">PHP</a><small>2</small></li>
	
  
	
		<li><a href="/categories/PHY/">PHY</a><small>1</small></li>
	
  
	
		<li><a href="/categories/Port/">Port</a><small>1</small></li>
	
  
	
		<li><a href="/categories/Python/">Python</a><small>4</small></li>
	
  
	
		<li><a class = "list-2"href="/categories/Swift/Released/">Released</a><small>1</small></li>
     
  
	
		<li><a href="/categories/Storage/">Storage</a><small>1</small></li>
	
  
	
		<li><a href="/categories/Swift/">Swift</a><small>5</small></li>
	
  
	
		<li><a href="/categories/TOEIC/">TOEIC</a><small>5</small></li>
	
  
	
		<li><a href="/categories/U-Boot/">U-Boot</a><small>1</small></li>
	
  
	
		<li><a href="/categories/Unity/">Unity</a><small>1</small></li>
	
  
	
		<li><a href="/categories/XCode/">XCode</a><small>1</small></li>
	
   -->
     <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Chrome/">Chrome</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/DataStructures/">DataStructures</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Firebase/">Firebase</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Firefox/">Firefox</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/GCC/">GCC</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Git/">Git</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/IOS/">IOS</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/IOS/BLE/">BLE</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Laravel/">Laravel</a><span class="category-list-count">8</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">14</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/ML/">ML</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Machine-Learning/">Machine-Learning</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/Composer/">Composer</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHY/">PHY</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Port/">Port</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Storage/">Storage</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Storage/Nand-Flash/">Nand-Flash</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Swift/">Swift</a><span class="category-list-count">5</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Swift/AutoLayout/">AutoLayout</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Swift/DesignPattern/">DesignPattern</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Swift/Released/">Released</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/TOEIC/">TOEIC</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/U-Boot/">U-Boot</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Unity/">Unity</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/XCode/">XCode</a><span class="category-list-count">1</span></li></ul> 
</div>
 

  
<div class="widget tag">
  <h3 class="title">標籤</h3>
  <ul class="entry">
  
    <li><a href="/tags/Add-on/">Add-on</a><small>5</small></li>
  
    <li><a href="/tags/Arduino/">Arduino</a><small>1</small></li>
  
    <li><a href="/tags/Authentication/">Authentication</a><small>1</small></li>
  
    <li><a href="/tags/BLE/">BLE</a><small>1</small></li>
  
    <li><a href="/tags/C/">C</a><small>8</small></li>
  
    <li><a href="/tags/Chrome/">Chrome</a><small>1</small></li>
  
    <li><a href="/tags/CloudMessaging/">CloudMessaging</a><small>1</small></li>
  
    <li><a href="/tags/Code/">Code</a><small>1</small></li>
  
    <li><a href="/tags/Composer/">Composer</a><small>1</small></li>
  
    <li><a href="/tags/DP/">DP</a><small>3</small></li>
  
    <li><a href="/tags/DataStructures/">DataStructures</a><small>2</small></li>
  
    <li><a href="/tags/Extend/">Extend</a><small>1</small></li>
  
    <li><a href="/tags/Extension/">Extension</a><small>1</small></li>
  
    <li><a href="/tags/Firebase/">Firebase</a><small>5</small></li>
  
    <li><a href="/tags/Firefox/">Firefox</a><small>5</small></li>
  
    <li><a href="/tags/GCC/">GCC</a><small>1</small></li>
  
    <li><a href="/tags/Git/">Git</a><small>1</small></li>
  
    <li><a href="/tags/Grammar/">Grammar</a><small>5</small></li>
  
    <li><a href="/tags/Hexo/">Hexo</a><small>3</small></li>
  
    <li><a href="/tags/I2C/">I2C</a><small>1</small></li>
  
    <li><a href="/tags/IOS/">IOS</a><small>1</small></li>
  
    <li><a href="/tags/Kernel/">Kernel</a><small>2</small></li>
  
    <li><a href="/tags/Laravel/">Laravel</a><small>8</small></li>
  
    <li><a href="/tags/Linux/">Linux</a><small>15</small></li>
  
    <li><a href="/tags/Linux（Process）/">Linux（Process）</a><small>1</small></li>
  
    <li><a href="/tags/ML/">ML</a><small>1</small></li>
  
    <li><a href="/tags/Machine-Learning/">Machine-Learning</a><small>4</small></li>
  
    <li><a href="/tags/Nand-Flash/">Nand-Flash</a><small>1</small></li>
  
    <li><a href="/tags/Other/">Other</a><small>1</small></li>
  
    <li><a href="/tags/PCI/">PCI</a><small>2</small></li>
  
    <li><a href="/tags/PHP/">PHP</a><small>1</small></li>
  
    <li><a href="/tags/PHY/">PHY</a><small>1</small></li>
  
    <li><a href="/tags/Port/">Port</a><small>1</small></li>
  
    <li><a href="/tags/Python/">Python</a><small>4</small></li>
  
    <li><a href="/tags/Ram/">Ram</a><small>1</small></li>
  
    <li><a href="/tags/RealtimeDatabase/">RealtimeDatabase</a><small>1</small></li>
  
    <li><a href="/tags/Semaphore/">Semaphore</a><small>1</small></li>
  
    <li><a href="/tags/Swift/">Swift</a><small>5</small></li>
  
    <li><a href="/tags/TOEIC/">TOEIC</a><small>5</small></li>
  
    <li><a href="/tags/U-Boot/">U-Boot</a><small>1</small></li>
  
    <li><a href="/tags/Unity/">Unity</a><small>1</small></li>
  
    <li><a href="/tags/Web/">Web</a><small>1</small></li>
  
    <li><a href="/tags/XCode/">XCode</a><small>1</small></li>
  
  </ul>
</div>

</aside>
    <div class="clearfix"></div>
  </div>
  <footer id="footer" class="inner"><div class="alignleft">
  
  &copy; 2017 JasonChiuCC
  
</div>

<div class="visit">
    本站總訪問量 <span id="busuanzi_value_site_pv"></span>次
</div>

<div class="clearfix"></div></footer>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>



<!-- 添加『不蒜子』計數服務 -->
<script async src="http://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>

</body>
</html>
